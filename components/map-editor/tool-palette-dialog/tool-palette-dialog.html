
<dialog class="tool-palette-dialog-component">
    <kit-if id="kitIfVisible" data-kit-condition="#model.isVisible()">
        <style>
            @scope (.tool-palette-dialog-component) {
                :scope {
                    height: 750px;
                    width: 750px;
                    scrollbar-color: var(--color-tertiary) var(--color-tertiary-container);
                }

                @media (max-width: 750px), (max-height: 850px) {
                    :scope {
                        position: absolute;
                        transform: unset;
                        top: 0;
                        bottom: 0;
                        left: 0;
                        right: 0;
                        max-height: 100%;
                        max-width: 100%;
                        height: 100%;
                        width: 100%;
                        padding-bottom: 50px;
                    }
                }

                .details-list {
                    height: 665px;
                    overflow-y: auto;
                    padding: 2px;
                    border: 1px solid;
                    border-color: var(--color-outline);
                    border-radius: 3px;
                }

                summary {
                    cursor: pointer;
                    padding: 8px;
                    margin-bottom: 1px;
                    border-radius: 3px;
                    border: 1px solid;
                    background-color: var(--color-tertiary-container);
                    color: var(--color-tertiary-container-on);
                    border-color: var(--color-tertiary-container-on);
                    box-shadow: var(--color-tertiary-container-on) 1px 1px 3px 0 inset, var(--color-tertiary-container-on) -1px -1px 3px 0 inset;
                }

                .details-list-2 {
                    overflow-y: auto;
                    padding: 0 0 2px 20px;
                    border-radius: 3px;
                }

                .detail-section {
                    display: flex;
                    padding-right: 0;
                }

                .detail-section > div {
                    flex-grow: 1;
                }

                .item-list {
                    min-height: 50px;
                    max-height: 300px;
                    overflow-y: auto;
                    padding: 2px;
                    border: 1px solid;
                    border-color: var(--color-outline);
                    border-radius: 3px;
                    margin-right: 10px;
                    background-color: var(--color-surface-container);
                }

                .tools-list,
                .map-item-templates-list,
                .fills-list,
                .strokes-list {
                    margin-right: 0;
                }

                .thumbnail-container {
                    height: 25px;
                    width: 25px;
                }

                .available-item {
                    display: flex;
                    padding: 0;
                    margin: 2px;
                    cursor: pointer;
                    outline: none;
                    border-radius: 3px;
                    border: 1px solid;
                    border-color: var(--color-secondary-container-on) !important;
                }

                .available-item label {
                    cursor: pointer;
                }

                .available-item .thumbnail-container {
                    margin: 5px;
                }

                .available-item .icon,
                .available-item .grip {
                    stroke: var(--color-secondary-container-on) !important;
                }

                .available-item:hover .icon,
                .available-item:hover .grip {
                    stroke: var(--color-primary-container-on-variant-2) !important;
                }

                .available-item div {
                    padding: 0;
                    margin: 0;
                }

                .available-item label {
                    display: block;
                    margin: 5px;
                }

                .tool-item,
                .map-item-template-item,
                .fill-item,
                .stroke-item {
                    display: flex;
                }

                .tool-item[data-selected="true"],
                .map-item-template-item[data-selected="true"],
                .fill-item[data-selected="true"],
                .stroke-item[data-selected="true"] {
                    color: var(--color-tertiary-container-on);
                    background-color: var(--color-tertiary-container);
                    box-shadow: var(--color-tertiary-container-on) 1px 1px 3px 0 inset, var(--color-tertiary-container-on) -1px -1px 3px 0 inset;
                }

                .tool-item[data-selected="true"] .icon,
                .tool-item[data-selected="true"] .grip,
                .map-item-template-item[data-selected="true"] .icon,
                .map-item-template-item[data-selected="true"] .grip,
                .fill-item[data-selected="true"] .icon,
                .fill-item[data-selected="true"] .grip,
                .stroke-item[data-selected="true"] .icon,
                .stroke-item[data-selected="true"] .grip {
                    stroke: var(--color-tertiary-container-on);
                }

                .tool-item[data-selected="true"] .icon-text,
                .map-item-template-item[data-selected="true"] .icon-text,
                .fill-item[data-selected="true"] .icon-text,
                .stroke-item[data-selected="true"] .icon-text {
                    stroke: var(--color-tertiary-container-on);
                    fill: var(--color-tertiary-container-on);
                }

                .tool-item div,
                .map-item-template-item div,
                .fill-item div,
                .stroke-item div {
                    margin: 2px;
                }

                .tool-item label,
                .map-item-template-item label,
                .fill-item label,
                .stroke-item label {
                    display: block;
                    margin: 2px;
                }

                .secondary-info {
                    font-size: smaller;
                    font-style: italic;
                    padding: 0;
                }

                .secondary-info label {
                    font-weight: normal;
                    margin: 5px 0 0 0;
                }

                .tool-item .secondary-info label,
                .map-item-template-item .secondary-info label,
                .fill-item .secondary-info label,
                .stroke-item .secondary-info label {
                    margin: 5px 2px 0 0;
                }

                .map-item-template-item .icon-container,
                .fill-item .icon-container,
                .stroke-item .icon-container {
                    margin-bottom: 10px;
                }

                .move-container button {
                    margin-left: -10px;
                    padding: 0;
                    height: 50px;
                    width: 30px;
                }

                .move-container button .icon-container {
                    margin-left: 5px;
                    margin-bottom: 30px;
                }

                button, .icon-container {
                    min-width: 25px;
                }

                .list-label-row {
                    display: flex;
                    padding: 0;
                    margin: 0;
                }

                .list-label-row div {
                    padding: 0;
                    margin: 0 0 4px 4px;
                }

                .list-label-row label {
                    margin-top: 24px;
                }

                fieldset {
                    border-radius: 3px;
                    border: 1px solid;
                    padding: 10px;
                }

                fieldset label {
                    display: block;
                    padding-top: 5px;
                }

                fieldset .inline-label {
                    display: unset;
                    font-weight: normal;
                    padding-left: 5px;
                }

                input[type="number"] {
                    width: 75px;
                }

                textarea {
                    width: 100%;
                    height: 75px;
                    white-space: pre-wrap;
                }

                fieldset[disabled],
                fieldset[disabled] input,
                fieldset[disabled] textarea,
                fieldset[disabled] select,
                fieldset[disabled] .radio-button .checkmark,
                fieldset[disabled] .checkbox .checkmark,
                fieldset[disabled] .item-list {
                    background-color: rgba(0, 0, 0, 0.1);
                }

                .validation-message {
                    font-weight: normal;
                    color: var(--color-alert-container-on);
                }

                .copy-map-item-template-button {
                    margin-right: 10px;
                    margin-bottom: 10px;
                }

                .img-preview {
                    border: 1px solid var(--color-outline);
                    border-radius: 3px;
                    margin-right: 6px;
                }

                .image-thumbnail {
                    height: 25px;
                    width: 25px;
                    border: 1px solid var(--color-outline);
                    border-radius: 3px;
                    background-position: center;
                }
            }
        </style>
        <header>
            <div class="icon-container">
                <kit-component data-kit-template-path="/resources/icons/tool-palette.html" data-kit-model="null"></kit-component>
            </div>
            <div>
                <h1>Edit tool palettes</h1>
            </div>
            <div class="spacer"></div>
            <div>
                <button title="Close" class="action-text" onclick="#model.closeDialog();">
                    <div class="icon-container">
                        <kit-component data-kit-template-path="/resources/icons/file-close.html" data-kit-model="null"></kit-component>
                    </div>
                </button>
            </div>
        </header>
        <section>
            <div id="top-details-list" class="details-list">

                <!-- Tool palettes -->
                <details id="details-tool-palettes" ontoggle="#model.onDetailsToggleEvent(event)">
                    <summary>Tool palettes</summary>
                    <div class="details-list-2">

                        <!-- Editing tools -->
                        <details id="details-tool-palettes-editing-tools" ontoggle="#model.onDetailsToggleEvent(event)">
                            <summary>Editing tools</summary>
                            <section class="detail-section">
                                <div>
                                    <label>Current palette</label>
                                    <div id="current-editing-tools" 
                                         class="item-list" 
                                         ondragover="#model.allowDrop(event)" 
                                         ondrop="#model.dropAvailableItem(event, 'EditingTools')">
                                        <kit-array data-kit-array="#model.getToolPalettes('EditingTools')" 
                                                   data-kit-item-index-ref="paletteIndex">
                                            <div>
                                                <kit-array data-kit-array="#model.getToolPaletteItems('EditingTools', #paletteIndex)" 
                                                           data-kit-item-ref="tool">
                                                    <button id="%{#tool.id}%"
                                                            data-tool-title="%{#tool.elementId}%"
                                                            class="tool-button editing-tool-button"
                                                            title="%{#tool.data.ref.name}%"
                                                            draggable="true"
                                                            ondragstart="#model.dragItem(event)">
                                                        <svg data-tool-thumbnail="%{#tool.elementId}%" 
                                                             height="25" 
                                                             width="25" 
                                                             viewBox="0 0 100 100">%{#tool.data.thumbnailSrc}%</svg>
                                                    </button>
                                                </kit-array>
                                            </div>
                                        </kit-array>
                                    </div>
                                </div>
                                <div>
                                    <label>Available tools</label>
                                    <div class="item-list" 
                                         ondragover="#model.allowDrop(event)" 
                                         ondrop="#model.dropPaletteItem(event, 'EditingTools')">
                                        <kit-array data-kit-array="#model.getAvailableItems('EditingTools')"  
                                                   data-kit-item-ref="tool">
                                            <div id="%{#tool.elementId}%" 
                                                 class="available-item tool-button" 
                                                 draggable="true" 
                                                 ondragstart="#model.dragItem(event)">
                                                <div class="icon-container thumbnail-container">
                                                    <svg data-tool-thumbnail="%{#tool.elementId}%" 
                                                         height="25" 
                                                         width="25" 
                                                         viewBox="0 0 100 100">%{#tool.thumbnailSrc}%</svg>
                                                </div>
                                                <div>
                                                    <label data-tool-name="%{#tool.elementId}%">%{#tool.name}%</label>
                                                </div>
                                                <div class="spacer"></div>
                                                <div class="secondary-info">
                                                    <label>%{#tool.referenceTypeLabel}%</label>
                                                    <label>%{#tool.versionLabel}%</label>
                                                </div>
                                                <div class="move-container">
                                                    <button title="Move" 
                                                            class="action-text"
                                                            onclick="#model.dragStartItem(event, #tool.elementId);">
                                                        <div class="icon-container">
                                                            <kit-component data-kit-template-path="/resources/icons/move.html" 
                                                                           data-kit-model="null">
                                                            </kit-component>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </kit-array>
                                    </div>
                                    <div>
                                        <a title="Manage tools" class="action-text" onclick="#model.openToolsSection()">Manage tools</a>
                                    </div>
                                </div>
                            </section>
                        </details>

                        <!-- Drawing tools -->
                        <details id="details-tool-palettes-drawing-tools" ontoggle="#model.onDetailsToggleEvent(event)">
                            <summary>Drawing tools</summary>
                            <section class="detail-section">
                                <div>
                                    <label>Current palette</label>
                                    <div id="current-drawing-tools" 
                                         class="item-list" 
                                         ondragover="#model.allowDrop(event)" 
                                         ondrop="#model.dropAvailableItem(event, 'DrawingTools')">
                                        <kit-array data-kit-array="#model.getToolPalettes('DrawingTools')" 
                                                   data-kit-item-index-ref="paletteIndex">
                                            <div>
                                                <kit-array data-kit-array="#model.getToolPaletteItems('DrawingTools', #paletteIndex)" 
                                                           data-kit-item-ref="tool">
                                                    <button id="%{#tool.id}%"
                                                            data-tool-title="%{#tool.elementId}%"
                                                            class="tool-button drawing-tool-button"
                                                            title="%{#tool.data.ref.name}%"
                                                            draggable="true"
                                                            ondragstart="#model.dragItem(event)">
                                                        <svg data-tool-thumbnail="%{#tool.elementId}%" 
                                                             height="25" 
                                                             width="25" 
                                                             viewBox="0 0 100 100">%{#tool.data.thumbnailSrc}%</svg>
                                                    </button>
                                                </kit-array>
                                            </div>
                                        </kit-array>
                                    </div>
                                </div>
                                <div>
                                    <label>Available tools</label>
                                    <div class="item-list" 
                                         ondragover="#model.allowDrop(event)" 
                                         ondrop="#model.dropPaletteItem(event, 'DrawingTools')">
                                        <kit-array data-kit-array="#model.getAvailableItems('DrawingTools')" 
                                                   data-kit-item-ref="tool">
                                            <div id="%{#tool.elementId}%" 
                                                 class="available-item tool-button" 
                                                 draggable="true" 
                                                 ondragstart="#model.dragItem(event)">
                                                <div class="icon-container thumbnail-container">
                                                    <svg data-tool-thumbnail="%{#tool.elementId}%" 
                                                         height="25" 
                                                         width="25" 
                                                         viewBox="0 0 100 100">%{#tool.thumbnailSrc}%</svg>
                                                </div>
                                                <div>
                                                    <label data-tool-name="%{#tool.elementId}%">%{#tool.name}%</label>
                                                </div>
                                                <div class="spacer"></div>
                                                <div class="secondary-info">
                                                    <label>%{#tool.referenceTypeLabel}%</label>
                                                    <label>%{#tool.versionLabel}%</label>
                                                </div>
                                                <div class="move-container">
                                                    <button title="Move" 
                                                            class="action-text" 
                                                            onclick="#model.dragStartItem(event, #tool.elementId);">
                                                        <div class="icon-container">
                                                            <kit-component data-kit-template-path="/resources/icons/move.html" 
                                                                           data-kit-model="null">
                                                            </kit-component>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </kit-array>
                                    </div>
                                    <div>
                                        <a title="Manage tools" class="action-text" onclick="#model.openToolsSection()">Manage tools</a>
                                    </div>
                                </div>
                            </section>
                        </details>

                        <!-- Map item templates -->
                        <details id="details-tool-palettes-map-item-templates" ontoggle="#model.onDetailsToggleEvent(event)">
                            <summary>Map item templates</summary>
                            <section class="detail-section">
                                <div>
                                    <label>Current palette</label>
                                    <div id="current-map-item-templates" 
                                         class="item-list" 
                                         ondragover="#model.allowDrop(event)" 
                                         ondrop="#model.dropAvailableItem(event, 'MapItemTemplates')">
                                        <kit-array data-kit-array="#model.getToolPalettes('MapItemTemplates')" 
                                                   data-kit-item-index-ref="paletteIndex">
                                            <div>
                                                <kit-array data-kit-array="#model.getToolPaletteItems('MapItemTemplates', #paletteIndex)" 
                                                           data-kit-item-ref="tool">
                                                    <button id="%{#tool.id}%"
                                                            data-map-item-template-title="%{#tool.elementId}%"
                                                            class="tool-button drawing-tool-button"
                                                            title="%{#tool.data.ref.name}%"
                                                            draggable="true"
                                                            ondragstart="#model.dragItem(event)">
                                                        <div class="image-thumbnail" data-map-item-template-thumbnail="%{#tool.elementId}%">
                                                        </div>
                                                    </button>
                                                </kit-array>
                                            </div>
                                        </kit-array>
                                    </div>
                                </div>
                                <div>
                                    <label>Available map item templates</label>
                                    <div class="item-list" 
                                         ondragover="#model.allowDrop(event)" 
                                         ondrop="#model.dropPaletteItem(event, 'MapItemTemplates')">
                                        <kit-array data-kit-array="#model.getAvailableItems('MapItemTemplates')" 
                                                   data-kit-item-ref="mapItemTemplate">
                                            <div id="%{#mapItemTemplate.elementId}%"
                                                 class="available-item tool-button"
                                                 draggable="true"
                                                 ondragstart="#model.dragItem(event)">
                                                <div style="margin:5px;">
                                                    <div class="image-thumbnail" data-map-item-template-thumbnail="%{#mapItemTemplate.elementId}%">
                                                    </div>
                                                </div>
                                                <div>
                                                    <label data-map-item-template-name="%{#mapItemTemplate.elementId}%">%{#mapItemTemplate.name}%</label>
                                                </div>
                                                <div class="spacer"></div>
                                                <div class="secondary-info">
                                                    <label>%{#mapItemTemplate.referenceTypeLabel}%</label>
                                                </div>
                                                <div class="move-container">
                                                    <button title="Move"
                                                            class="action-text"
                                                            onclick="#model.dragStartItem(event, #mapItemTemplate.elementId);">
                                                        <div class="icon-container">
                                                            <kit-component data-kit-template-path="/resources/icons/move.html"
                                                                           data-kit-model="null">
                                                            </kit-component>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </kit-array>
                                    </div>
                                    <div>
                                        <a title="Manage map item templates" 
                                           class="action-text" 
                                           onclick="#model.openMapItemTemplatesSection()">Manage map item templates</a>
                                    </div>
                                </div>
                            </section>
                        </details>

                    </div>
                </details>

                <!-- Tools -->
                <details id="details-tools" ontoggle="#model.onDetailsToggleEvent(event)">
                    <summary>Tools</summary>
                    <section>
                        <div class="list-label-row">
                            <label>Tools:</label>
                            <div class="spacer"></div>
                            <div>
                                <button id="add-tool-button" title="Add tool" class="button dialog-button" onclick="#model.addTool();">
                                    <div class="icon-container">
                                        <kit-component data-kit-template-path="/resources/icons/add.html" data-kit-model="null"></kit-component>
                                    </div>
                                </button>
                            </div>
                            <div>
                                <button id="delete-tool-button" 
                                        title="Delete tool" 
                                        class="button dialog-button" 
                                        onclick="#model.deleteTool();" 
                                        data-kit-add-attributes="%{#model.canDeleteToolAttribute()}%">
                                    <div class="icon-container">
                                        <kit-component data-kit-template-path="/resources/icons/delete.html" data-kit-model="null"></kit-component>
                                    </div>
                                </button>
                            </div>
                        </div>
                        <div class="item-list tools-list">
                            <kit-array data-kit-array="#model.getTools()" 
                                       data-kit-item-ref="tool">
                                <div id="%{#tool.elementId}%" 
                                     class="tool-item tool-button" 
                                     onclick="#model.selectTool(#tool.elementId)"
                                     data-selected="%{#tool.isSelected}%">
                                    <div class="icon-container">
                                        <svg data-tool-thumbnail="%{#tool.elementId}%" 
                                             height="25" 
                                             width="25" 
                                             viewBox="0 0 100 100">%{#tool.thumbnailSrc}%</svg>
                                    </div>
                                    <div>
                                        <label data-tool-name="%{#tool.elementId}%">%{#tool.name}%</label>
                                        <div class="secondary-info">
                                            <label data-tool-type="%{#tool.elementId}%">%{#tool.toolTypeLabel}%</label>
                                        </div>
                                    </div>
                                    <div class="spacer"></div>
                                    <div class="secondary-info">
                                        <label>%{#tool.referenceTypeLabel}%</label>
                                        <label data-tool-version="%{#tool.elementId}%">%{#tool.versionLabel}%</label>
                                    </div>
                                </div>
                            </kit-array>
                        </div>
                        <div>
                            <kit-if id="currentToolForm" data-kit-condition="#model.hasCurrentTool()">
                                <kit-component 
                                    data-kit-template-path="/components/map-editor/tool-palette-dialog/tool-view/tool-view.html"
                                    data-kit-model-input="{ tool: #model.getCurrentTool() }">
                                </kit-component>
                            </kit-if>
                        </div>
                    </section>
                </details>

                <!-- Map item templates -->
                <details id="details-map-item-templates" ontoggle="#model.onDetailsToggleEvent(event)">
                    <summary>Map item templates</summary>
                    <section>
                        <div class="list-label-row">
                            <label>Map item templates:</label>
                            <div class="spacer"></div>
                            <div>
                                <button id="add-map-item-template-button" 
                                        title="Add map item template" 
                                        class="button dialog-button" 
                                        onclick="#model.addMapItemTemplate();">
                                    <div class="icon-container">
                                        <kit-component data-kit-template-path="/resources/icons/add.html" data-kit-model="null"></kit-component>
                                    </div>
                                </button>
                            </div>
                            <div>
                                <button id="delete-map-item-template-button" 
                                        title="Delete map item template" 
                                        class="button dialog-button" 
                                        onclick="#model.deleteMapItemTemplate();"
                                        data-kit-add-attributes="%{#model.canDeleteMapItemTemplateAttribute()}%">
                                    <div class="icon-container">
                                        <kit-component data-kit-template-path="/resources/icons/delete.html" data-kit-model="null"></kit-component>
                                    </div>
                                </button>
                            </div>
                        </div>
                        <div class="item-list map-item-templates-list">
                            <kit-array data-kit-array="#model.getMapItemTemplates()" 
                                       data-kit-item-ref="mapItemTemplate">
                                <div id="%{#mapItemTemplate.elementId}%"
                                     class="map-item-template-item tool-button"
                                     onclick="#model.selectMapItemTemplate(#mapItemTemplate.elementId)"
                                     data-selected="%{#mapItemTemplate.isSelected}%">
                                    <div style="padding:4px;max-height:30px">
                                        <div id="thumbnail-preview" class="image-thumbnail" data-map-item-template-thumbnail="%{#mapItemTemplate.elementId}%">  
                                        </div>
                                    </div>
                                    <div>
                                        <label data-map-item-template-name="%{#mapItemTemplate.elementId}%">%{#mapItemTemplate.name}%</label>
                                    </div>
                                    <div class="spacer"></div>
                                    <button title="Copy map item template"
                                            class="action-text copy-map-item-template-button"
                                            onclick="#model.copyMapItemTemplate(#mapItemTemplate.elementId);">
                                        <div class="icon-container">
                                            <kit-component data-kit-template-path="/resources/icons/edit-copy.html" data-kit-model="null"></kit-component>
                                        </div>
                                    </button>
                                    <div class="secondary-info">
                                        <label>%{#mapItemTemplate.referenceTypeLabel}%</label>
                                        <label data-map-item-template-version="%{#mapItemTemplate.elementId}%">%{#mapItemTemplate.versionLabel}%</label>
                                    </div>
                                </div>
                            </kit-array>
                        </div>
                        <div>
                            <kit-if id="currentMapItemTemplateForm" data-kit-condition="#model.hasCurrentMapItemTemplate()">
                                <kit-component data-kit-template-path="/components/map-editor/tool-palette-dialog/map-item-template-view/map-item-template-view.html" 
                                               data-kit-model-input="{ mapItemTemplate: #model.getCurrentMapItemTemplate() }">
                                </kit-component>
                            </kit-if>
                        </div>
                    </section>
                </details>

            </div>
        </section>
    </kit-if>
</dialog>
